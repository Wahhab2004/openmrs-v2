"use strict";(globalThis.webpackChunk_openmrs_esm_service_queues_app=globalThis.webpackChunk_openmrs_esm_service_queues_app||[]).push([[50],{3223:(e,t,o)=>{o.d(t,{Z:()=>s});var a=o(272),r=o.n(a),n=o(2609),i=o.n(n)()(r());i.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79;--bottom-nav-height: 4rem;--workspace-header-height: 3rem;--tablet-workspace-window-height: calc(100vh - var(--omrs-navbar-height));--desktop-workspace-window-height: calc(100vh - var(--omrs-navbar-height) - var(--workspace-header-height))}.-esm-service-queues__add-provider-queue-room__section___WHhMV{margin:.5rem}.-esm-service-queues__add-provider-queue-room__sectionTitle___ArcWQ{font-size:var(--cds-heading-compact-02-font-size, 1rem);font-weight:var(--cds-heading-compact-02-font-weight, 600);line-height:var(--cds-heading-compact-02-line-height, 1.375);letter-spacing:var(--cds-heading-compact-02-letter-spacing, 0);color:#525252;margin-bottom:.75rem}.-esm-service-queues__add-provider-queue-room__checkbox___VEBx1{padding-top:.75rem}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/add-provider-queue-room/add-provider-queue-room.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CACA,yBAAA,CACA,+BAAA,CACA,yEAAA,CACA,2GAAA,CCvDF,+DACE,YCgBW,CDbb,oEE01BI,uDAAA,CAAA,0DAAA,CAAA,4DAAA,CAAA,8DAAA,CFx1BF,aDLQ,CCMR,oBCeW,CDZb,gEACE,kBCWW",sourceRoot:""}]),i.locals={section:"-esm-service-queues__add-provider-queue-room__section___WHhMV",sectionTitle:"-esm-service-queues__add-provider-queue-room__sectionTitle___ArcWQ",checkbox:"-esm-service-queues__add-provider-queue-room__checkbox___VEBx1"};const s=i},7050:(e,t,o)=>{o.r(t),o.d(t,{default:()=>B});var a=o(5206),r=o.n(a),n=o(4924),i=o(8427),s=o(2870),u=o(1995),l=o(3255);function c(e){var t,o="".concat(s.restBaseUrl,"/roomprovidermap?provider=").concat(e),a=(0,l.ZP)(e?o:null,s.openmrsFetch),r=a.data,n=a.error,i=a.isLoading,u=a.mutate;return{providerRoom:r?null==r||null===(t=r.data)||void 0===t?void 0:t.results:[],isError:n,isLoading:i,mutate:u}}var d=o(3670),m=o(1354),v=o.n(m),p=o(1583),h=o.n(p),A=o(7378),g=o.n(A),_=o(5993),f=o.n(_),b=o(4154),C=o.n(b),y=o(8141),S=o.n(y),q=o(3223),E={};E.styleTagTransform=S(),E.setAttributes=f(),E.insert=g().bind(null,"head"),E.domAPI=h(),E.insertStyleElement=C(),v()(q.Z,E);const k=q.Z&&q.Z.locals?q.Z.locals:void 0;var w=o(2312);function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,a=new Array(t);o<t;o++)a[o]=e[o];return a}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a,r,n=[],i=!0,s=!1;try{for(o=o.call(e);!(i=(a=o.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){s=!0,r=e}finally{try{i||null==o.return||o.return()}finally{if(s)throw r}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return R(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(o):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?R(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const B=function(e){var t=e.providerUuid,o=e.closeModal,m=(0,n.useTranslation)().t,v=(0,d.fn)(),p=(0,d.SY)(),h=(0,d.vM)(),A=(0,d.fn)(),g=(0,d.Hp)(),_=c(t),f=_.providerRoom,b=(_.isLoading,T((0,a.useState)(""),2)),C=b[0],y=b[1],S=T((0,a.useState)(""),2),q=S[0],E=S[1];(0,a.useEffect)((function(){var e;(null==f?void 0:f.length)>0&&(y(null===(e=null==f?void 0:f[0].queueRoom)||void 0===e?void 0:e.uuid),E(null==f?void 0:f[0].uuid))}),[f]);var R=c(t).mutate,B=(0,w.y)(p).queues,L=function(e,t){var o,a=t?"".concat(s.restBaseUrl,"/queueroom?location=").concat(e,"&queue=").concat(t):"".concat(s.restBaseUrl,"/queueroom?location=").concat(e),r=(0,l.ZP)(e?a:null,s.openmrsFetch),n=r.data,i=r.error,u=r.isLoading;return{rooms:n?null==n||null===(o=n.data)||void 0===o?void 0:o.results:[],isError:i,isLoading:u}}(p,h).rooms,x=(0,u.J)().queueLocations,I=T((0,a.useState)(!1),2),Q=I[0],D=I[1],U=(0,a.useCallback)((function(){C?(D(!1),(null==f?void 0:f.length)>0?function(e,t,o){var a=new AbortController;return(0,s.openmrsFetch)("".concat(s.restBaseUrl,"/roomprovidermap/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},signal:a.signal,body:{queueRoom:{uuid:t},provider:{uuid:o}}})}(q,C,t).then((function(e){200===e.status&&((0,s.showSnackbar)({isLowContrast:!0,title:m("updateRoom","Update room"),kind:"success",subtitle:m("queueRoomUpdatedSuccessfully","Queue room updated successfully")}),o(),localStorage.setItem("lastUpdatedQueueRoomTimestamp",(new Date).toString()),(0,d.By)(new Date),R())}),(function(e){(0,s.showSnackbar)({title:m("queueRoomAddFailed","Error adding queue room"),kind:"error",isLowContrast:!1,subtitle:null==e?void 0:e.message}),o()})):function(e,t){var o=new AbortController;return(0,s.openmrsFetch)("".concat(s.restBaseUrl,"/roomprovidermap"),{method:"POST",headers:{"Content-Type":"application/json"},signal:o.signal,body:{queueRoom:{uuid:e},provider:{uuid:t}}})}(C,t).then((function(e){201===e.status&&((0,s.showSnackbar)({isLowContrast:!0,title:m("addRoom","Add room"),kind:"success",subtitle:m("queueRoomAddedSuccessfully","Queue room added successfully")}),o(),localStorage.setItem("lastUpdatedQueueRoomTimestamp",(new Date).toString()),(0,d.By)(new Date),R())}),(function(e){(0,s.showSnackbar)({title:m("queueRoomAddFailed","Error adding queue room"),kind:"error",isLowContrast:!1,subtitle:null==e?void 0:e.message})}))):D(!0)}),[C,null==f?void 0:f.length,q,t,m,o,R]);return r().createElement("div",null,r().createElement(i.xBx,{closeModal:o,title:m("addProviderQueueRoom","Add provider queue room?")}),r().createElement(i.fef,null,r().createElement(i.l09,{onSubmit:U},r().createElement("section",{className:k.section},r().createElement("div",{className:k.sectionTitle},m("queueLocation","Queue location")),r().createElement(i.Ltx,{id:"queueLocation","aria-label":m("selectQueueLocation","Select a queue location"),label:"",type:"default",items:x,itemToString:function(e){return e?e.name:""},onChange:function(e){var t=e.selectedItem;localStorage.setItem("queueLocationUuid",t.id),localStorage.setItem("queueLocationName",t.name),(0,d.yl)(t.name),(0,d._j)(t.id)},size:"md",initialSelectedItem:{uuid:p,name:v}})),r().createElement("section",{className:k.section},r().createElement("div",{className:k.sectionTitle},m("queueService","Queue service")),r().createElement(i.Ltx,{id:"service","aria-label":m("selectService","Select a service"),type:"default",label:"",items:B,itemToString:function(e){return e?e.display:""},onChange:function(e){var t=e.selectedItem;localStorage.setItem("queueServiceName",t.name),localStorage.setItem("queueServiceUuid",t.uuid),(0,d.yk)(t.name),(0,d.u_)(t.uuid)},size:"md",initialSelectedItem:{uuid:h,display:A}})),r().createElement("section",{className:k.section},r().createElement("div",{className:k.sectionTitle},m("queueRoom","Queue room")),r().createElement("div",{className:k.filterContainer},r().createElement(i.PhF,{labelText:m("selectRoom","Select a room"),id:"service",invalidText:"Required",value:C,defaultValue:C,onChange:function(e){y(e.target.value),localStorage.setItem("lastUpdatedQueueRoomTimestamp",(new Date).toString())}},C?null:r().createElement(i.QlF,{text:m("chooseRoom","Select a room"),value:""}),(null==L?void 0:L.length)>0&&L.map((function(e){return r().createElement(i.QlF,{key:e.uuid,text:e.display,value:e.uuid},e.display)}))))),Q&&r().createElement("section",null,r().createElement(i.K0D,{style:{margin:"0",minWidth:"100%"},kind:"error",lowContrast:!0,title:m("missingQueueRoom","Please select a queue room")})),r().createElement("section",{className:k.section},r().createElement(i.XZJ,{onChange:function(e){localStorage.setItem("isPermanentProviderQueueRoom",JSON.parse(e.target.checked)),(0,d.wE)(JSON.parse(e.target.checked))},checked:g,labelText:m("retainLocation","Retain location"),id:"retianLocation",className:k.checkbox})))),r().createElement(i.mzw,null,r().createElement(i.zxk,{kind:"secondary",onClick:o},m("cancel","Cancel")),r().createElement(i.zxk,{onClick:U},m("save","Save"))))}}}]);