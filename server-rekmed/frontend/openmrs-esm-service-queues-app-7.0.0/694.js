"use strict";(globalThis.webpackChunk_openmrs_esm_service_queues_app=globalThis.webpackChunk_openmrs_esm_service_queues_app||[]).push([[694],{7674:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(272),a=n.n(r),i=n(2609),o=n.n(i)()(a());o.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79;--bottom-nav-height: 4rem;--workspace-header-height: 3rem;--tablet-workspace-window-height: calc(100vh - var(--omrs-navbar-height));--desktop-workspace-window-height: calc(100vh - var(--omrs-navbar-height) - var(--workspace-header-height))}#-esm-service-queues__remove-queue-entry__subHeading___YoXVP{font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px);color:#161616}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/remove-queue-entry-dialog/remove-queue-entry.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CACA,yBAAA,CACA,+BAAA,CACA,yEAAA,CACA,2GAAA,CCxDF,6DC+1BI,2DAAA,CAAA,0DAAA,CAAA,8DAAA,CAAA,mEAAA,CD71BF,aDDM",sourceRoot:""}]),o.locals={subHeading:"-esm-service-queues__remove-queue-entry__subHeading___YoXVP"};const s=o},5694:(e,t,n)=>{n.r(t),n.d(t,{default:()=>z});var r=n(5206),a=n.n(r),i=n(4924),o=n(8427),s=n(2870),u=n(8179),l=n(8879),c=n.n(l),d=n(8053),p=n(3255),h=n(9457);function m(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,a)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){m(i,r,a,o,s,"next",e)}function s(e){m(i,r,a,o,s,"throw",e)}o(void 0)}))}}var f=function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},A=c()(new Date).format(u.J$);function b(){return b=v((function(e,t,n,r,a,i){var o;return f(this,(function(u){switch(u.label){case 0:return o=new AbortController,r?((null==i?void 0:i.length)&&i.forEach((l=v((function(e){return f(this,(function(t){switch(t.label){case 0:return[4,Promise.all([y("Completed",e.uuid)])];case 1:return t.sent(),[2]}}))})),function(e){return l.apply(this,arguments)})),[4,Promise.all([(0,d.TW)(e,t,n)])]):[3,2];case 1:return u.sent(),[2,(0,s.updateVisit)(a,r,o).pipe((0,h.P)()).subscribe((function(e){return e.status}),(function(e){return e}))];case 2:return[4,Promise.all([(0,d.TW)(e,t,n)]).then((function(e){return e})).catch((function(e){return e}))];case 3:return[2,u.sent()];case 4:return[2]}var l}))})),b.apply(this,arguments)}function y(e,t){return g.apply(this,arguments)}function g(){return(g=v((function(e,t){var n;return f(this,(function(r){return n="".concat(s.restBaseUrl,"/appointments/").concat(t,"/status-change"),[2,(0,s.openmrsFetch)(n,{body:{toStatus:e,onDate:A,timeZone:u.EQ},method:"POST",headers:{"Content-Type":"application/json"}})]}))}))).apply(this,arguments)}var w=n(1354),C=n.n(w),_=n(1583),k=n.n(_),E=n(7378),D=n.n(E),q=n(5993),T=n.n(q),P=n(4154),x=n.n(P),B=n(8141),V=n.n(B),S=n(7674),Q={};Q.styleTagTransform=V(),Q.setAttributes=T(),Q.insert=D().bind(null,"head"),Q.domAPI=k(),Q.insertStyleElement=x(),C()(S.Z,Q);const U=S.Z&&S.Z.locals?S.Z.locals:void 0;var Z=n(9561);const z=function(e){var t=e.queueEntry,n=e.closeModal,r=(0,i.useTranslation)().t,l=(0,s.useVisit)(t.patientUuid).currentVisit,c=(0,Z.Q)().mutateQueueEntries,d=function(e,t){var n,r=new AbortController,a="".concat(s.restBaseUrl,"/appointments/search"),i=(0,p.ZP)(a,(function(){return(0,s.openmrsFetch)(a,{method:"POST",signal:r.signal,headers:{"Content-Type":"application/json"},body:{patientUuid:e,startDate:t}})})),o=i.data,u=i.error,l=i.isLoading,c=i.isValidating,d=(null==o||null===(n=o.data)||void 0===n?void 0:n.length)?o.data.filter((function(e){return"CheckedIn"===e.status})):null;return{data:o?d:null,isError:u,isLoading:l,isValidating:c}}(t.patientUuid,u.b7),h=d.data;return a().createElement("div",null,a().createElement(o.xBx,{closeModal:n,label:r("serviceQueue","Service queue"),title:r("removeFromQueueAndEndVisit","Remove patient from queue and end active visit?")}),a().createElement(o.fef,null,a().createElement("p",{className:U.subHeading,id:"subHeading"},r("endVisitWarningMessage","Ending this visit will remove this patient from the queue and will not allow you to fill another encounter form for this patient"))),a().createElement(o.mzw,null,a().createElement(o.zxk,{kind:"secondary",onClick:n},r("cancel","Cancel")),a().createElement(o.zxk,{kind:"danger",onClick:function(){var e,a,i={location:null==l||null===(e=l.location)||void 0===e?void 0:e.uuid,startDatetime:(0,s.parseDate)(null==l?void 0:l.startDatetime),visitType:null==l||null===(a=l.visitType)||void 0===a?void 0:a.uuid,stopDatetime:new Date},o=new Date;(function(e,t,n,r,a,i){return b.apply(this,arguments)})(t.queue.uuid,t.queueEntryUuid,o,i,t.visitUuid,h).then((function(e){n(),c(),(0,s.showSnackbar)({isLowContrast:!0,kind:"success",subtitle:r("queueEntryRemovedSuccessfully","Queue entry removed successfully"),title:r("queueEntryRemoved","Queue entry removed")})}))}},r("endVisit","End visit"))))}}}]);