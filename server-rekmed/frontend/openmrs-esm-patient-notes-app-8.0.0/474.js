(globalThis.webpackChunk_openmrs_esm_patient_notes_app=globalThis.webpackChunk_openmrs_esm_patient_notes_app||[]).push([[474],{1368:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(272),o=n.n(r),i=n(2609),a=n.n(i)()(o());a.push([e.id,":root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79;--bottom-nav-height: 4rem;--workspace-header-height: 3rem;--tablet-workspace-window-height: calc(100vh - var(--omrs-navbar-height));--desktop-workspace-window-height: calc(100vh - var(--omrs-navbar-height) - var(--workspace-header-height))}.-esm-patient-notes__notes-overview__widgetCard___birMz{border:1px solid #e0e0e0}.-esm-patient-notes__notes-overview__expandedRow___v_Gc7>td{padding-left:2.5rem !important}.-esm-patient-notes__notes-overview__expandedRow___v_Gc7>td>div{max-height:max-content !important}.-esm-patient-notes__notes-overview__expandedRow___v_Gc7 th[colspan] td[colspan]>div:first-child{padding:0 1rem}.-esm-patient-notes__notes-overview__copy___ZJPsO{font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px);display:flex;flex-direction:column}.-esm-patient-notes__notes-overview__container___n8apy{margin:.5rem}.-esm-patient-notes__notes-overview__metadata___sFTBw{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px);color:#525252;margin:.5rem 0}.-esm-patient-notes__notes-overview__hiddenRow___zo2KM{display:none}","",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/notes/notes-overview.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CACA,yBAAA,CACA,+BAAA,CACA,yEAAA,CACA,2GAAA,CCvDF,wDACE,wBAAA,CAGF,4DACE,8BAAA,CAGF,gEACE,iCAAA,CAGF,iGACE,cAAA,CAGF,kDC80BI,gDAAA,CAAA,+CAAA,CAAA,mDAAA,CAAA,wDAAA,CD30BF,YAAA,CACA,qBAAA,CAGF,uDACE,YAAA,CAGF,sDCm0BI,gDAAA,CAAA,gDAAA,CAAA,oDAAA,CAAA,yDAAA,CDj0BF,aD5BQ,CC6BR,cAAA,CAGF,uDACE,YAAA",sourceRoot:""}]),a.locals={widgetCard:"-esm-patient-notes__notes-overview__widgetCard___birMz",expandedRow:"-esm-patient-notes__notes-overview__expandedRow___v_Gc7",copy:"-esm-patient-notes__notes-overview__copy___ZJPsO",container:"-esm-patient-notes__notes-overview__container___n8apy",metadata:"-esm-patient-notes__notes-overview__metadata___sFTBw",hiddenRow:"-esm-patient-notes__notes-overview__hiddenRow___zo2KM"};const s=a},6474:(e,t,n)=>{"use strict";n.r(t),n.d(t,{importTranslation:()=>X,notesOverview:()=>te,startupApp:()=>ee,visitNotesActionButton:()=>ne,visitNotesFormWorkspace:()=>re});var r=n(2870),o={visitNoteConfig:{clinicianEncounterRole:{_type:r.Type.UUID,_default:"240b26f9-dd88-4172-823d-4a8bfeb7841f"},visitDiagnosesConceptUuid:{_type:r.Type.ConceptUuid,_default:"159947AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},encounterNoteTextConceptUuid:{_type:r.Type.ConceptUuid,_default:"162169AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},encounterTypeUuid:{_type:r.Type.UUID,_default:"d7151f82-c1f3-4152-a605-2f9ea7414a79"},formConceptUuid:{_type:r.Type.ConceptUuid,_default:"c75f120a-04ec-11e3-8780-2b40bef9a44b"}},numberOfVisitsToLoad:{_type:r.Type.Number,_description:"The number of visits to load initially in the Visits Summary tab. Defaults to 5",_default:5},diagnosisConceptClass:{_type:r.Type.UUID,_description:"The concept class to use for the diagnoses",_default:"8d4918b0-c2cc-11de-8d13-0010c6dffd0f"}},i=n(268),a=n.n(i),s=n(4924),l=n(5676),c=n(810),u=n(2821),d=n(3236),p=n(2779),v=n.n(p),m=n(5598),A=n(9523),f=n(5660);const g=function(e,t,n){for(var r=-1,o=Object(e),i=n(e),a=i.length;a--;){var s=i[++r];if(!1===t(o[s],s,o))break}return e};var y=n(2198);var _=n(3282);const b=(h=function(e,t){return e&&g(e,t,y.Z)},function(e,t){if(null==e)return e;if(!(0,_.Z)(e))return h(e,t);for(var n=e.length,r=-1,o=Object(e);++r<n&&!1!==t(o[r],r,o););return e});var h;var w=n(3225),C=n(2758);const D=function(e,t){if(e!==t){var n=void 0!==e,r=null===e,o=e==e,i=(0,C.Z)(e),a=void 0!==t,s=null===t,l=t==t,c=(0,C.Z)(t);if(!s&&!c&&!i&&e>t||i&&a&&l&&!s&&!c||r&&a&&l||!n&&l||!o)return 1;if(!r&&!i&&!c&&e<t||c&&n&&o&&!r&&!i||s&&n&&o||!a&&o||!l)return-1}return 0};var E=n(9930),O=n(7885);const P=function(e,t,n){t=t.length?(0,m.Z)(t,(function(e){return(0,O.Z)(e)?function(t){return(0,A.Z)(t,1===e.length?e[0]:e)}:e})):[E.Z];var r=-1;t=(0,m.Z)(t,(0,w.Z)(f.Z));var o=function(e,t){var n=-1,r=(0,_.Z)(e)?Array(e.length):[];return b(e,(function(e,o,i){r[++n]=t(e,o,i)})),r}(e,(function(e,n,o){return{criteria:(0,m.Z)(t,(function(t){return t(e)})),index:++r,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(o,(function(e,t){return function(e,t,n){for(var r=-1,o=e.criteria,i=t.criteria,a=o.length,s=n.length;++r<a;){var l=D(o[r],i[r]);if(l)return r>=s?l:l*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}))},T=function(e,t,n,r){return null==e?[]:((0,O.Z)(t)||(t=null==t?[]:[t]),n=r?void 0:n,(0,O.Z)(n)||(n=null==n?[]:[n]),P(e,t,n))};var k=n(321),S=n.n(k),j=n(1195),N=n.n(j),x=n(3275),U=n.n(x),B=n(7162),R=n.n(B),z=n(2094),F=n.n(z),Z=n(757),L=n.n(Z),V=n(1368),I={};I.styleTagTransform=L(),I.setAttributes=R(),I.insert=U().bind(null,"head"),I.domAPI=N(),I.insertStyleElement=F(),S()(V.Z,I);const G=V.Z&&V.Z.locals?V.Z.locals:void 0;function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){H(e,t,n[t])}))}return e}const q=function(e){var t,n,o=e.notes,c=e.pageSize,d=e.pageUrl,p=e.urlLabel,m=(0,s.useTranslation)().t,A="tablet"===(0,r.useLayoutType)(),f=(t=(0,i.useState)({key:"",order:"none"}),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),g=f[0],y=f[1],_=[{key:"encounterDate",header:m("date","Date")},{key:"diagnoses",header:m("diagnoses","Diagnoses")}],b=g.key,h=g.order,w="encounterDate"===b?function(e,t){return T(e,[function(e){return new Date(e.encounterDate).getTime()}],"ASC"===t?["desc"]:["asc"])}(o,h):T(o,[b],"DESC"===h?["desc"]:["asc"]),C=(0,r.usePagination)(w,c),D=C.results,E=C.goTo,O=C.currentPage,P=a().useMemo((function(){return null==D?void 0:D.map((function(e){return t=W({},e),n=null!=(n={id:"".concat(e.id),encounterDate:(0,r.formatDate)((0,r.parseDate)(e.encounterDate),{mode:"wide"}),diagnoses:e.diagnoses?e.diagnoses:"--"})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t;var t,n}))}),[D]);return a().createElement(a().Fragment,null,a().createElement(l.wQF,{rows:P,sortRow:function(e,t,n){var r=n.sortDirection,o=(n.sortStates,function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(n,["sortDirection","sortStates"]).key);y({key:o,order:r})},headers:_,isSortable:!0,size:A?"lg":"sm",useZebraStyles:!0},(function(e){var t=e.rows,n=e.headers,o=e.getExpandHeaderProps,i=e.getTableProps,s=e.getTableContainerProps,c=e.getHeaderProps,u=e.getRowProps;return a().createElement(l.xJi,s,a().createElement(l.iA_,i(),a().createElement(l.ssF,null,a().createElement(l.SCH,null,a().createElement(l.MOD,W({enableToggle:!0},o())),n.map((function(e,t){return a().createElement(l.xDH,W({key:t,className:v()(G.productiveHeading01,G.text02)},c({header:e})),e.header)})))),a().createElement(l.RMI,null,t.map((function(e,t){var o,i,s,c,d;return a().createElement(a().Fragment,{key:e.id},a().createElement(l.RcE,u({row:e}),e.cells.map((function(e){return a().createElement(l.pj1,{key:e.id},e.value)}))),e.isExpanded?a().createElement(l.WdL,{className:G.expandedRow,colSpan:n.length+1},a().createElement("div",{className:G.container,key:t},(null==P||null===(o=P[t])||void 0===o?void 0:o.encounterNote)?a().createElement("div",{className:G.copy},a().createElement("span",{className:G.content},null==P||null===(i=P[t])||void 0===i?void 0:i.encounterNote),a().createElement("span",{className:G.metadata},(0,r.formatTime)(new Date(null==P||null===(s=P[t])||void 0===s?void 0:s.encounterNoteRecordedAt))," Â·"," ",null==P||null===(c=P[t])||void 0===c?void 0:c.encounterProvider,", ",null==P||null===(d=P[t])||void 0===d?void 0:d.encounterProviderRole)):a().createElement("span",{className:G.copy},m("noVisitNoteToDisplay","No visit note to display")))):a().createElement(l.WdL,{className:G.hiddenRow,colSpan:n.length+2}))})))))})),a().createElement(u.PatientChartPagination,{pageNumber:O,totalItems:o.length,currentItems:D.length,pageSize:c,onPageNumberChange:function(e){var t=e.page;return E(t)},dashboardLinkUrl:d,dashboardLinkLabel:p}))};function J(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Y=function(e){var t=e.patientUuid,n=e.pageSize,o=e.urlLabel,i=e.pageUrl,p=(0,s.useTranslation)().t,v=(0,r.useVisit)(t).currentVisit,m=p("visitNotes","Visit notes"),A=p("visitNotes","Visit notes"),f=(0,d.q6)(t),g=f.visitNotes,y=f.isError,_=f.isLoading,b=f.isValidating,h=(0,r.useLayoutType)(),w="large-desktop"===h||"small-desktop"===h,C=a().useCallback((function(){v?(0,u.launchPatientWorkspace)("visit-notes-form-workspace"):(0,u.launchStartVisitPrompt)()}),[v]);return _?a().createElement(l.gqd,{role:"progressbar",compact:w,zebra:!0}):y?a().createElement(u.ErrorState,{error:y,headerTitle:A}):(null==g?void 0:g.length)?a().createElement("div",{className:G.widgetCard},a().createElement(u.CardHeader,{title:A},a().createElement("span",null,b?a().createElement(l.lSo,null):null),a().createElement(l.zxk,{kind:"ghost",renderIcon:function(e){return a().createElement(c.mm,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){J(e,t,n[t])}))}return e}({size:16},e))},iconDescription:"Add visit note",onClick:C},p("add","Add"))),a().createElement(q,{notes:g,pageSize:n,urlLabel:o,pageUrl:i})):a().createElement(u.EmptyState,{displayText:m,headerTitle:A,launchForm:C})};var K=n(1174);var Q="@openmrs/esm-patient-notes-app",$={featureName:"patient-notes",moduleName:Q},X=n(3979);function ee(){(0,r.messageOmrsServiceWorker)({type:"registerDynamicRoute",pattern:".+".concat(r.restBaseUrl,"/encounter.+")}),(0,r.defineConfigSchema)(Q,o)}var te=(0,r.getSyncLifecycle)((function(e){var t=e.patientUuid,n=e.patient,r=(e.basePath,(0,s.useTranslation)().t),o="${openmrsSpaBase}/patient/".concat(n.id,"/chart/Forms & Notes"),i=r("seeAll","See all");return a().createElement(Y,{patientUuid:t,pageSize:5,urlLabel:i,pageUrl:o})}),$),ne=(0,r.getSyncLifecycle)((function(){var e=(0,s.useTranslation)().t,t=(0,u.useLaunchWorkspaceRequiringVisit)("visit-notes-form-workspace");return a().createElement(r.ActionMenuButton,{getIcon:function(e){return a().createElement(K.Gm,e)},label:e("visitNote","Visit note"),iconDescription:e("note","Note"),handler:t,type:"visit-note"})}),$),re=(0,r.getAsyncLifecycle)((function(){return Promise.all([n.e(99),n.e(623)]).then(n.bind(n,2623))}),$)},3236:(e,t,n)=>{"use strict";n.d(t,{BH:()=>d,OD:()=>l,aH:()=>u,ov:()=>c,q6:()=>s});var r=n(3255),o=n(9285),i=n.n(o),a=n(2870);function s(e){var t,n,o,i=(0,a.useConfig)().visitNoteConfig,s=i.encounterNoteTextConceptUuid,l=i.visitDiagnosesConceptUuid,c="".concat(a.restBaseUrl,"/encounter?patient=").concat(e,"&obs=").concat(l,"&v=").concat("custom:(uuid,display,encounterDatetime,patient,obs,encounterProviders:(uuid,display,encounterRole:(uuid,display),provider:(uuid,person:(uuid,display))),diagnoses"),u=(0,r.ZP)(c,a.openmrsFetch),d=u.data,p=u.error,v=u.isLoading,m=u.isValidating,A=u.mutate,f=null==d||null===(o=d.data)||void 0===o||null===(n=o.results)||void 0===n||null===(t=n.map((function(e,t){var n,r,o,i,a,l,c;return{id:"".concat(t),diagnoses:e.diagnoses.map((function(e){return e.display})).filter((function(e){return e})).join(", "),encounterDate:e.encounterDatetime,encounterNote:null===(n=e.obs.find((function(e){return e.concept.uuid===s})))||void 0===n?void 0:n.value,encounterNoteRecordedAt:null===(r=e.obs.find((function(e){return e.concept.uuid===s})))||void 0===r?void 0:r.obsDatetime,encounterProvider:null==e||null===(a=e.encounterProviders[0])||void 0===a||null===(i=a.provider)||void 0===i||null===(o=i.person)||void 0===o?void 0:o.display,encounterProviderRole:null==e||null===(c=e.encounterProviders[0])||void 0===c||null===(l=c.encounterRole)||void 0===l?void 0:l.display}})))||void 0===t?void 0:t.sort((function(e,t){return new Date(t.encounterDate).getTime()-new Date(e.encounterDate).getTime()}));return{visitNotes:d?f:null,isError:p,isLoading:v,isValidating:m,mutateVisitNotes:A}}function l(e){var t,n,r=(0,a.useConfig)(),o=i()(e?function(t,n){var o,i=r.numberOfVisitsToLoad;if(n&&!(null==n||null===(o=n.data)||void 0===o?void 0:o.links.some((function(e){return"next"===e.rel}))))return null;var s="".concat(a.restBaseUrl,"/visit?patient=").concat(e,"&v=").concat("custom:(uuid,encounters:(uuid,diagnoses:(uuid,display,rank,diagnosis),form:(uuid,display),encounterDatetime,orders:full,obs:full,encounterType:(uuid,display,viewPrivilege,editPrivilege),encounterProviders:(uuid,display,encounterRole:(uuid,display),provider:(uuid,person:(uuid,display)))),visitType:(uuid,name,display),startDatetime,stopDatetime,patient,attributes:(attributeType:ref,display,uuid,value)","&limit=").concat(i);return t&&(s+="&startIndex=".concat(t*i)),s}:null,a.openmrsFetch,{parallel:!0}),s=o.data,l=o.error,c=o.isLoading,u=o.isValidating,d=o.mutate,p=o.size,v=o.setSize;return{visits:s?[].concat(null==s?void 0:s.flatMap((function(e){return e.data.results}))):null,error:l,hasMore:!!(null==s?void 0:s.length)&&!!(null===(n=s[s.length-1].data)||void 0===n||null===(t=n.links)||void 0===t?void 0:t.some((function(e){return"next"===e.rel}))),isLoading:c,isValidating:u,mutateVisits:d,setSize:v,size:p}}function c(e,t){var n="".concat(a.restBaseUrl,"/concept?name=").concat(e,"&searchType=fuzzy&class=").concat(t,"&v=").concat("custom:(uuid,display)");return(0,a.openmrsFetch)(n).then((function(e){var t=e.data;return Promise.resolve(t.results)}))}function u(e,t){return(0,a.openmrsFetch)("".concat(a.restBaseUrl,"/encounter"),{headers:{"Content-Type":"application/json"},method:"POST",body:t,signal:e.signal})}function d(e,t){return(0,a.openmrsFetch)("".concat(a.restBaseUrl,"/patientdiagnoses"),{headers:{"Content-Type":"application/json"},method:"POST",body:t})}},3979:(e,t,n)=>{var r={"./am.json":[8788,788],"./ar.json":[4460,460],"./en.json":[3574,574],"./es.json":[8319,319],"./fr.json":[2757,757],"./he.json":[5833,833],"./km.json":[7807,807],"./zh.json":[8271,271],"./zh_CN.json":[1644,644]};function o(e){if(!n.o(r,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],o=t[0];return n.e(t[1]).then((()=>n(o)))}o.keys=()=>Object.keys(r),o.id=3979,e.exports=o}}]);