"use strict";(globalThis.webpackChunk_openmrs_esm_fast_data_entry_app=globalThis.webpackChunk_openmrs_esm_fast_data_entry_app||[]).push([[188],{2815:(t,e,r)=>{r.d(e,{Ay:()=>U,NX:()=>v,Z1:()=>p});var n=r(6072),i=r.n(n),o=r(5846),u=r(7114),a=r(944),c=r(5987);function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable})))),n.forEach((function(e){s(t,e,r[e])}))}return t}var d={addPatient:function(t){},openPatientSearch:function(){},saveEncounter:function(t){},editEncounter:function(t){},submitForNext:function(){},submitForReview:function(){},submitForComplete:function(){},goToReview:function(){},destroySession:function(){},closeSession:function(){}},v={activeFormUuid:null,forms:{},workflowState:null,activePatientUuid:null,activeEncounterUuid:null,patientUuids:[],encounters:{},singleSessionVisitTypeUuid:null,userUuid:null},m=i().createContext(f({},v,d)),p=function(t){var e,r,s,p,U,y,b,S,w,E,h,O,F,g,P,T,_,I,A,j,k,R,N,M=t.children,C=(0,c.useSession)().user,D=(0,u.useParams)().formUuid.split("&")[0],V=(0,u.useLocation)().search,B=new URLSearchParams(V).get("patientUuid"),x=(j=(0,n.useReducer)(o.Ay,f({},v,d)),k=2,function(t){if(Array.isArray(t))return t}(j)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o=[],u=!0,a=!1;try{for(r=r.call(t);!(u=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);u=!0);}catch(t){a=!0,i=t}finally{try{u||null==r.return||r.return()}finally{if(a)throw i}}return o}}(j,k)||function(t,e){if(t){if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}(j,k)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),L=x[0],W=x[1],X=(0,a.A)("@openmrs/esm-fast-data-entry-app.groupSessionVisitTypeUuid"),$=null==X||null===(p=X.result)||void 0===p||null===(s=p.data)||void 0===s||null===(r=s.results)||void 0===r||null===(e=r[0])||void 0===e?void 0:e.value,G=(0,n.useMemo)((function(){return{initializeWorkflowState:function(t){var e=t.activeFormUuid,r=t.newPatientUuid;return W({type:"INITIALIZE_WORKFLOW_STATE",activeFormUuid:e,newPatientUuid:r,userUuid:C.uuid})},addPatient:function(t){return W({type:"ADD_PATIENT",patientUuid:t})},openPatientSearch:function(){return W({type:"OPEN_PATIENT_SEARCH"})},saveEncounter:function(t){return W({type:"SAVE_ENCOUNTER",encounterUuid:t})},submitForNext:function(){return W({type:"SUBMIT_FOR_NEXT"})},submitForReview:function(){return W({type:"SUBMIT_FOR_REVIEW"})},submitForComplete:function(){return W({type:"SUBMIT_FOR_COMPLETE"})},editEncounter:function(t){return W({type:"EDIT_ENCOUNTER",patientUuid:t})},goToReview:function(){return W({type:"GO_TO_REVIEW"})},destroySession:function(){return W({type:"DESTROY_SESSION"})},closeSession:function(){return W({type:"CLOSE_SESSION"})}}}),[C]);return(0,n.useEffect)((function(){null===(null==L?void 0:L.workflowState)&&D&&G.initializeWorkflowState({activeFormUuid:D,newPatientUuid:B})}),[D,B,null==L?void 0:L.workflowState,G]),i().createElement(m.Provider,{value:(R=f({},L,G),N={workflowState:null!==(P=null===(y=L.forms)||void 0===y||null===(U=y[L.activeFormUuid])||void 0===U?void 0:U.workflowState)&&void 0!==P?P:v.workflowState,activePatientUuid:null!==(T=null===(S=L.forms)||void 0===S||null===(b=S[L.activeFormUuid])||void 0===b?void 0:b.activePatientUuid)&&void 0!==T?T:v.activePatientUuid,activeEncounterUuid:null!==(_=null===(E=L.forms)||void 0===E||null===(w=E[L.activeFormUuid])||void 0===w?void 0:w.activeEncounterUuid)&&void 0!==_?_:v.activeEncounterUuid,patientUuids:null!==(I=null===(O=L.forms)||void 0===O||null===(h=O[L.activeFormUuid])||void 0===h?void 0:h.patientUuids)&&void 0!==I?I:v.patientUuids,encounters:null!==(A=null===(g=L.forms)||void 0===g||null===(F=g[L.activeFormUuid])||void 0===F?void 0:F.encounters)&&void 0!==A?A:v.encounters,singleSessionVisitTypeUuid:$},N=null!=N?N:{},Object.getOwnPropertyDescriptors?Object.defineProperties(R,Object.getOwnPropertyDescriptors(N)):function(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r.push.apply(r,n)}return r}(Object(N)).forEach((function(t){Object.defineProperty(R,t,Object.getOwnPropertyDescriptor(N,t))})),R)},M)};const U=m},5846:(t,e,r)=>{r.d(e,{Ay:()=>U,KA:()=>d,dd:()=>v});var n=r(5987),i=r(2815);function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable})))),n.forEach((function(e){u(t,e,r[e])}))}return t}function c(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r.push.apply(r,n)}return r}(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})),t}function l(t,e){if(null==t)return{};var r,n,i=function(t,e){if(null==t)return{};var r,n,i={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(i[r]=t[r]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function s(t){var e=function(t,e){if("object"!==f(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===f(e)?e:String(e)}function f(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}var d="1.1.0",v="openmrs:fastDataEntryWorkflowState",m=function(t){localStorage.setItem(v+":"+t.userUuid,JSON.stringify(t))},p={workflowState:"NEW_PATIENT",activePatientUuid:null,activeEncounterUuid:null,patientUuids:[],encounters:{}};const U=function(t,e){switch(e.type){case"INITIALIZE_WORKFLOW_STATE":var r,f=localStorage.getItem(v+":"+e.userUuid),U=f?JSON.parse(f):{},y={},b=e.newPatientUuid?{activePatientUuid:e.newPatientUuid,workflowState:"EDIT_FORM"}:{};return f&&U._storageVersion===d?(y=c(a({},U),{activeFormUuid:e.activeFormUuid,forms:c(a({},U.forms),u({},e.activeFormUuid,c(a({},p,U.forms[e.activeFormUuid],b),{patientUuids:(null===(r=U.forms[e.activeFormUuid])||void 0===r?void 0:r.patientUuids)||p.patientUuids})))}),e.newPatientUuid&&!y.forms[e.activeFormUuid].patientUuids.includes(e.newPatientUuid)&&y.forms[e.activeFormUuid].patientUuids.push(e.newPatientUuid)):y=c(a({},i.NX),{_storageVersion:d,forms:u({},e.activeFormUuid,p),activeFormUuid:e.activeFormUuid,userUuid:e.userUuid}),m(y),a({},y);case"ADD_PATIENT":var S=c(a({},t),{forms:c(a({},t.forms),u({},t.activeFormUuid,c(a({},t.forms[t.activeFormUuid]),{patientUuids:(R=t.forms[t.activeFormUuid].patientUuids,function(t){if(Array.isArray(t))return o(t)}(R)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(R)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}(R)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([e.patientUuid]),activePatientUuid:e.patientUuid,activeEncounterUuid:null,workflowState:"EDIT_FORM"})))});return m(S),S;case"OPEN_PATIENT_SEARCH":var w=c(a({},t),{forms:c(a({},t.forms),u({},t.activeFormUuid,c(a({},t.forms[t.activeFormUuid]),{activePatientUuid:null,activeEncounterUuid:null,workflowState:"NEW_PATIENT"})))});return m(w),w;case"SAVE_ENCOUNTER":if("SUBMIT_FOR_COMPLETE"===t.forms[t.activeFormUuid].workflowState){var E=t.forms,h=t.activeFormUuid,O=(E[h],l(E,[h].map(s))),F=c(a({},t),{forms:O,activeFormUuid:null});return m(F),(0,n.navigate)({to:"${openmrsSpaBase}/forms"}),F}var g=c(a({},t),{forms:c(a({},t.forms),u({},t.activeFormUuid,c(a({},t.forms[t.activeFormUuid]),{encounters:c(a({},t.forms[t.activeFormUuid].encounters),u({},t.forms[t.activeFormUuid].activePatientUuid,e.encounterUuid)),activePatientUuid:null,activeEncounterUuid:null,workflowState:"SUBMIT_FOR_NEXT"===t.forms[t.activeFormUuid].workflowState?"NEW_PATIENT":"SUBMIT_FOR_REVIEW"===t.forms[t.activeFormUuid].workflowState?"REVIEW":t.forms[t.activeFormUuid].workflowState})))});return m(g),g;case"EDIT_ENCOUNTER":var P=c(a({},t),{forms:c(a({},t.forms),u({},t.activeFormUuid,c(a({},t.forms[t.activeFormUuid]),{activeEncounterUuid:t.forms[t.activeFormUuid].encounters[e.patientUuid],activePatientUuid:e.patientUuid,workflowState:"EDIT_FORM"})))});return m(P),P;case"SUBMIT_FOR_NEXT":return window.dispatchEvent(new CustomEvent("ampath-form-action",{detail:{formUuid:t.activeFormUuid,patientUuid:t.forms[t.activeFormUuid].activePatientUuid,action:"onSubmit"}})),c(a({},t),{forms:c(a({},t.forms),u({},t.activeFormUuid,c(a({},t.forms[t.activeFormUuid]),{workflowState:"SUBMIT_FOR_NEXT"})))});case"SUBMIT_FOR_REVIEW":return window.dispatchEvent(new CustomEvent("ampath-form-action",{detail:{formUuid:t.activeFormUuid,patientUuid:t.forms[t.activeFormUuid].activePatientUuid,action:"onSubmit"}})),c(a({},t),{forms:c(a({},t.forms),u({},t.activeFormUuid,c(a({},t.forms[t.activeFormUuid]),{workflowState:"SUBMIT_FOR_REVIEW"})))});case"SUBMIT_FOR_COMPLETE":return window.dispatchEvent(new CustomEvent("ampath-form-action",{detail:{formUuid:t.activeFormUuid,patientUuid:t.forms[t.activeFormUuid].activePatientUuid,action:"onSubmit"}})),c(a({},t),{forms:c(a({},t.forms),u({},t.activeFormUuid,c(a({},t.forms[t.activeFormUuid]),{workflowState:"SUBMIT_FOR_COMPLETE"})))});case"GO_TO_REVIEW":var T=c(a({},t),{forms:c(a({},t.forms),u({},t.activeFormUuid,c(a({},t.forms[t.activeFormUuid]),{activeEncounterUuid:null,activePatientUuid:null,workflowState:"REVIEW"})))});return m(T),T;case"DESTROY_SESSION":var _=t.forms,I=t.activeFormUuid,A=(_[I],l(_,[I].map(s))),j=c(a({},t),{forms:A,activeFormUuid:null});return m(j),(0,n.navigate)({to:"${openmrsSpaBase}/forms"}),j;case"CLOSE_SESSION":var k=c(a({},t),{activeFormUuid:null});return m(k),(0,n.navigate)({to:"${openmrsSpaBase}/forms"}),k;default:return t}var R}},1511:(t,e,r)=>{r.d(e,{Ay:()=>y,D8:()=>v,oU:()=>m});var n=r(5987),i=r(2815),o=r(2302);function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable})))),n.forEach((function(e){a(t,e,r[e])}))}return t}function l(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r.push.apply(r,n)}return r}(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})),t}function s(t,e){if(null==t)return{};var r,n,i=function(t,e){if(null==t)return{};var r,n,i={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(i[r]=t[r]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function f(t){var e=function(t,e){if("object"!==d(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===d(e)?e:String(e)}function d(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}var v="1.0.5",m="openmrs:fastDataEntryGroupWorkflowState",p=function(t){localStorage.setItem(m+":"+t.userUuid,JSON.stringify(t))},U={workflowState:"NEW_GROUP_SESSION",groupUuid:null,groupName:null,groupMembers:[],activePatientUuid:null,activeEncounterUuid:null,activeVisitUuid:null,activeSessionUuid:null,patientUuids:[],encounters:{},visits:{}};const y=function(t,e){switch(e.type){case"INITIALIZE_WORKFLOW_STATE":var r=localStorage.getItem(m+":"+e.userUuid),d=r?JSON.parse(r):{},y={};if(r&&d._storageVersion===v){var b,S,w,E,h=null===(b=d.forms)||void 0===b?void 0:b[e.activeFormUuid],O=(null==h?void 0:h.activePatientUuid)||(null==h||null===(S=h.patientUuids)||void 0===S?void 0:S[0])||null,F=(null==h?void 0:h.activeSessionUuid)||(0,o.A)();y=l(c({},d),{activeFormUuid:e.activeFormUuid,forms:l(c({},d.forms),a({},e.activeFormUuid,l(c({},U,h),{activePatientUuid:O,activeEncounterUuid:(null==h||null===(w=h.encounters)||void 0===w?void 0:w[O])||null,activeVisitUuid:(null==h||null===(E=h.visits)||void 0===E?void 0:E[O])||null,activeSessionUuid:F})))})}else y=l(c({},i.NX),{_storageVersion:v,forms:a({},e.activeFormUuid,U),activeFormUuid:e.activeFormUuid,userUuid:e.userUuid});return p(y),y;case"SET_GROUP":var g,P,T,_,I=l(c({},t),{forms:l(c({},t.forms),a({},t.activeFormUuid,l(c({},t.forms[t.activeFormUuid]),{groupUuid:e.group.uuid,groupName:e.group.name,patientUuids:null!==(T=null===(g=e.group.cohortMembers)||void 0===g?void 0:g.map((function(t){var e;return null==t||null===(e=t.patient)||void 0===e?void 0:e.uuid})))&&void 0!==T?T:[],groupMembers:null!==(_=null===(P=e.group.cohortMembers)||void 0===P?void 0:P.map((function(t){var e;return null==t||null===(e=t.patient)||void 0===e?void 0:e.uuid})))&&void 0!==_?_:[],activePatientUuid:null,activeEncounterUuid:null,activeVisitUuid:null,activeSessionUuid:null})))});return p(I),I;case"UNSET_GROUP":var A=l(c({},t),{forms:l(c({},t.forms),a({},t.activeFormUuid,l(c({},t.forms[t.activeFormUuid]),{groupUuid:null,groupName:null,patientUuids:[],groupMembers:[],activePatientUuid:null,activeEncounterUuid:null,activeVisitUuid:null,activeSessionUuid:null})))});return p(A),A;case"SET_SESSION_META":var j,k,R,N=l(c({},t),{forms:l(c({},t.forms),a({},t.activeFormUuid,l(c({},t.forms[t.activeFormUuid]),{sessionMeta:e.meta,activePatientUuid:null===(j=t.forms[t.activeFormUuid].patientUuids)||void 0===j?void 0:j[0],activeEncounterUuid:t.forms[t.activeFormUuid].encounters[null===(k=t.forms[t.activeFormUuid].patientUuids)||void 0===k?void 0:k[0]]||null,activeVisitUuid:t.forms[t.activeFormUuid].visits[null===(R=t.forms[t.activeFormUuid].patientUuids)||void 0===R?void 0:R[0]]||null,activeSessionUuid:(0,o.A)(),workflowState:"EDIT_FORM"})))});return p(N),N;case"ADD_PATIENT_UUID":if(t.forms[t.activeFormUuid].patientUuids.includes(e.patientUuid))return t;var M=l(c({},t),{forms:l(c({},t.forms),a({},t.activeFormUuid,l(c({},t.forms[t.activeFormUuid]),{patientUuids:(Q=t.forms[t.activeFormUuid].patientUuids,function(t){if(Array.isArray(t))return u(t)}(Q)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(Q)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,e):void 0}}(Q)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([e.patientUuid])})))});return p(M),M;case"REMOVE_PATIENT_UUID":var C,D=l(c({},t),{forms:l(c({},t.forms),a({},t.activeFormUuid,l(c({},t.forms[t.activeFormUuid]),{patientUuids:null===(C=t.forms[t.activeFormUuid].patientUuids)||void 0===C?void 0:C.filter((function(t){return e.patientUuid!==t}))})))});return p(D),D;case"SAVE_ENCOUNTER":var V=t.forms[t.activeFormUuid];if("SUBMIT_FOR_COMPLETE"===V.workflowState){var B=t.forms,x=t.activeFormUuid,L=(B[x],s(B,[x].map(f))),W=l(c({},t),{forms:L,activeFormUuid:null});return p(W),(0,n.navigate)({to:"${openmrsSpaBase}/forms"}),W}if("SUBMIT_FOR_NEXT"===V.workflowState){var X=t.nextPatientUuid?t.nextPatientUuid:V.patientUuids[Math.min(V.patientUuids.indexOf(V.activePatientUuid)+1,V.patientUuids.length-1)],$=l(c({},V.encounters),a({},V.activePatientUuid,e.encounterUuid)),G=l(c({},t),{forms:l(c({},t.forms),a({},t.activeFormUuid,l(c({},V),{encounters:$,activePatientUuid:X,activeEncounterUuid:$[X]||null,activeVisitUuid:V.visits[X]||null,activeSessionUuid:V.activeSessionUuid,workflowState:"EDIT_FORM"})))});return p(G),G}return t;case"EDIT_ENCOUNTER":var q=l(c({},t),{forms:l(c({},t.forms),a({},t.activeFormUuid,l(c({},t.forms[t.activeFormUuid]),{activeEncounterUuid:t.forms[t.activeFormUuid].encounters[e.patientUuid],activeVisitUuid:t.forms[t.activeFormUuid].visits[e.patientUuid],activePatientUuid:e.patientUuid,activeSessionUuid:e.activeSessionUuid,workflowState:"EDIT_FORM"})))});return p(q),q;case"VALIDATE_FOR_NEXT":return window.dispatchEvent(new CustomEvent("ampath-form-action",{detail:{formUuid:t.activeFormUuid,patientUuid:t.forms[t.activeFormUuid].activePatientUuid,action:"validateForm"}})),l(c({},t),{forms:l(c({},t.forms),a({},t.activeFormUuid,l(c({},t.forms[t.activeFormUuid]),{workflowState:"VALIDATE_FOR_NEXT"})))});case"UPDATE_VISIT_UUID":return l(c({},t),{forms:l(c({},t.forms),a({},t.activeFormUuid,l(c({},t.forms[t.activeFormUuid]),{visits:l(c({},t.forms[t.activeFormUuid].visits),a({},t.forms[t.activeFormUuid].activePatientUuid,e.visitUuid)),activeVisitUuid:e.visitUuid})))});case"SUBMIT_FOR_NEXT":return window.dispatchEvent(new CustomEvent("ampath-form-action",{detail:{formUuid:t.activeFormUuid,patientUuid:t.forms[t.activeFormUuid].activePatientUuid,action:"onSubmit"}})),l(c({},t),{forms:l(c({},t.forms),a({},t.activeFormUuid,l(c({},t.forms[t.activeFormUuid]),{workflowState:"SUBMIT_FOR_NEXT"}))),nextPatientUuid:e.nextPatientUuid});case"SUBMIT_FOR_REVIEW":return window.dispatchEvent(new CustomEvent("ampath-form-action",{detail:{formUuid:t.activeFormUuid,patientUuid:t.forms[t.activeFormUuid].activePatientUuid,action:"onSubmit"}})),l(c({},t),{forms:l(c({},t.forms),a({},t.activeFormUuid,l(c({},t.forms[t.activeFormUuid]),{workflowState:"SUBMIT_FOR_REVIEW"})))});case"VALIDATE_FOR_COMPLETE":return window.dispatchEvent(new CustomEvent("ampath-form-action",{detail:{formUuid:t.activeFormUuid,patientUuid:t.forms[t.activeFormUuid].activePatientUuid,action:"validateForm"}})),l(c({},t),{forms:l(c({},t.forms),a({},t.activeFormUuid,l(c({},t.forms[t.activeFormUuid]),{workflowState:"VALIDATE_FOR_COMPLETE"})))});case"SUBMIT_FOR_COMPLETE":return window.dispatchEvent(new CustomEvent("ampath-form-action",{detail:{formUuid:t.activeFormUuid,patientUuid:t.forms[t.activeFormUuid].activePatientUuid,action:"onSubmit"}})),l(c({},t),{forms:l(c({},t.forms),a({},t.activeFormUuid,l(c({},t.forms[t.activeFormUuid]),{workflowState:"SUBMIT_FOR_COMPLETE"})))});case"GO_TO_REVIEW":var J=l(c({},t),{forms:l(c({},t.forms),a({},t.activeFormUuid,l(c({},t.forms[t.activeFormUuid]),{activeEncounterUuid:null,activVisitUuid:null,activePatientUuid:null,activeSessionUuid:null,workflowState:"REVIEW"})))});return p(J),J;case"DESTROY_SESSION":var K=t.forms,Z=t.activeFormUuid,H=(K[Z],s(K,[Z].map(f))),Y=l(c({},t),{forms:H,activeFormUuid:null});return p(Y),(0,n.navigate)({to:"${openmrsSpaBase}/forms"}),l(c({},Y),{formDestroyed:!0});case"CLOSE_SESSION":var z=l(c({},t),{activeFormUuid:null});return p(z),(0,n.navigate)({to:"${openmrsSpaBase}/forms"}),z;default:return t}var Q}},8453:(t,e,r)=>{r.d(e,{mr:()=>l,XT:()=>p,J0:()=>s.A,tD:()=>w});var n=r(5987),i=r(7626);function o(t,e,r,n,i,o,u){try{var a=t[o](u),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,i)}function u(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var u=t.apply(e,r);function a(t){o(u,n,i,a,c,"next",t)}function c(t){o(u,n,i,a,c,"throw",t)}a(void 0)}))}}var a="(uuid,name,display,encounterType:(uuid,name,viewPrivilege,editPrivilege),version,published,retired,resources:(uuid,name,dataType,valueReference))",c="".concat(n.restBaseUrl,"/form?v=custom:").concat(a);"".concat(n.restBaseUrl,"/form?v=custom:").concat(a,"&q=poc");const l=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=(0,n.useSession)(),r=c,o=(0,i.Ay)([r,t],u((function(){var t,e,i,o;return function(t,e){var r,n,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,n=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!((i=(i=u.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=e.call(t,u)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(u){switch(u.label){case 0:return[4,(0,n.openmrsFetch)(r)];case 1:return i=u.sent(),[2,null!==(o=null===(e=i.data)||void 0===e||null===(t=e.results)||void 0===t?void 0:t.filter((function(t){return t.published&&!/component/i.test(t.name)})))&&void 0!==o?o:[]]}}))}))),a=o.data,l=o.error;return{forms:null==a?void 0:a.filter((function(t){var r,i;return Boolean((0,n.userHasAccess)(null===(i=t.encounterType)||void 0===i||null===(r=i.editPrivilege)||void 0===r?void 0:r.display,null==e?void 0:e.user))})),isLoading:!l&&!a,error:l}};var s=r(1690),f=r(6072);function d(t,e,r,n,i,o,u){try{var a=t[o](u),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,i)}function v(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function u(t){d(o,n,i,u,a,"next",t)}function a(t){d(o,n,i,u,a,"throw",t)}u(void 0)}))}}var m="".concat(n.restBaseUrl,"/encounter/");const p=function(t){var e="".concat(m).concat(t),r=(0,i.Ay)(e,v((function(){return function(t,e){var r,n,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,n=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!((i=(i=u.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=e.call(t,u)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(t){switch(t.label){case 0:return[4,(0,n.openmrsFetch)(e)];case 1:return[2,t.sent().data||null]}}))}))),o=r.data,u=r.error;return{encounter:o,isLoading:!u&&o,error:u}};function U(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function y(t,e,r,n,i,o,u){try{var a=t[o](u),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,i)}function b(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o=[],u=!0,a=!1;try{for(r=r.call(t);!(u=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);u=!0);}catch(t){a=!0,i=t}finally{try{u||null==r.return||r.return()}finally{if(a)throw i}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return U(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?U(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r(5721);var S=function(t){var e,r,i=t.endpointUrl,o=b((0,f.useState)(null),2),u=o[0],a=o[1],c=b((0,f.useState)(null),2),l=c[0],s=c[1],d=b((0,f.useState)(null),2),v=d[0],m=d[1],p=(0,f.useCallback)((function(t){a(!1),v&&m(null),s(t.data)}),[v]),U=(0,f.useCallback)((function(t){var e,r,n;a(!1),l&&s(null),m(null!==(n=null!==(r=null==t||null===(e=t.responseBody)||void 0===e?void 0:e.error)&&void 0!==r?r:null==t?void 0:t.responseBody)&&void 0!==n?n:t)}),[l]),S=(0,f.useCallback)((e=function(t){var e;return function(t,e){var r,n,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,n=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!((i=(i=u.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=e.call(t,u)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(r){return a(!0),e=i,t.uuid&&(e+="/"+t.uuid),[2,(0,n.openmrsFetch)(e,{method:"POST",headers:{"Content-Type":"application/json"},body:t}).then(p).catch(U)]}))},r=function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function u(t){y(o,n,i,u,a,"next",t)}function a(t){y(o,n,i,u,a,"throw",t)}u(void 0)}))},function(t){return r.apply(this,arguments)}),[i,U,p]);return{post:S,isPosting:u,result:l,error:v,reset:function(){a(null),s(null),m(null)}}},w=function(){return S({endpointUrl:"".concat(n.restBaseUrl,"/cohortm/cohort")})}},5721:(t,e,r)=>{r.d(e,{A:()=>a});var n=r(5987),i=r(7626),o=r(6072),u="".concat(n.restBaseUrl,"/o3/forms");const a=function(t,e){var r=(0,o.useMemo)((function(){return function(t,e){return e.filter((function(e){return e.forms.includes(t)})).map((function(t){return t.questionId}))}(t,e)}),[t,e]),a=(0,i.Ay)(r?"".concat(u,"/").concat(t):null,n.openmrsFetch),c=a.data,l=a.error;return{questions:function(t,e){if(!e||t.lenght<=0)return[];var r=e.conceptReferences;return e.pages.flatMap((function(e){return e.sections.flatMap((function(e){return e.questions.filter((function(e){return t.includes(e.id)})).map((function(t){var e,n,i;return{question:{display:null!==(n=t.label)&&void 0!==n?n:null===(e=r[t.questionOptions.concept])||void 0===e?void 0:e.display,id:t.id},answers:(null!==(i=t.questionOptions.answers)&&void 0!==i?i:[]).map((function(t){var e,n;return{value:t.concept,display:null!==(n=t.label)&&void 0!==n?n:null===(e=r[t.concept])||void 0===e?void 0:e.display}}))}}))}))}))}(r,null==c?void 0:c.data)||null,isError:l,isLoading:!c&&!l}}},1690:(t,e,r)=>{r.d(e,{A:()=>a});var n=r(5987),i=r(6072);function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e,r,n,i,o,u){try{var a=t[o](u),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,i)}const a=function(t){var e,r,a=(e=(0,i.useState)(null),r=2,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o=[],u=!0,a=!1;try{for(r=r.call(t);!(u=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);u=!0);}catch(t){a=!0,i=t}finally{try{u||null==r.return||r.return()}finally{if(a)throw i}}return o}}(e,r)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=a[0],l=a[1];(0,i.useEffect)((function(){t?d(t):l(null)}),[t]);var s,f,d=(s=function(t){var e;return function(t,e){var r,n,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,n=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!((i=(i=u.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=e.call(t,u)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(r){switch(r.label){case 0:return[4,(0,n.fetchCurrentPatient)(t)];case 1:return e=r.sent(),l(e),[2]}}))},f=function(){var t=this,e=arguments;return new Promise((function(r,n){var i=s.apply(t,e);function o(t){u(i,r,n,o,a,"next",t)}function a(t){u(i,r,n,o,a,"throw",t)}o(void 0)}))},function(t){return f.apply(this,arguments)});return c}},944:(t,e,r)=>{r.d(e,{A:()=>a});var n=r(6072),i=r(5987);function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o=[],u=!0,a=!1;try{for(r=r.call(t);!(u=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);u=!0);}catch(t){a=!0,i=t}finally{try{u||null==r.return||r.return()}finally{if(a)throw i}}return o}}(t,e)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const a=function(t){var e=u((0,n.useState)(!1),2),r=e[0],o=e[1],a=u((0,n.useState)(null),2),c=a[0],l=a[1],s=u((0,n.useState)(null),2),f=s[0],d=s[1],v=(0,n.useCallback)((function(t){o(!1),d(!1),l(t)}),[]),m=(0,n.useCallback)((function(t){o(!1),l(null),d(t)}),[]),p=(0,n.useCallback)((function(){(0,i.openmrsFetch)("".concat(i.restBaseUrl,"/systemsetting?q=").concat(t,"&v=default")).then(v).catch(m)}),[m,v,t]);return(0,n.useEffect)((function(){p()}),[p]),{result:c,error:f,isSubmitting:r}}}}]);